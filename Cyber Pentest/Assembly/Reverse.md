In ELF, Segments contains Sections, Sections contains data with the same attributes. So Segment is a collection of data with the same Attributes

**Read the different segment of ELF program**
```shell
readelf -l [ELF]
```

**Segments schema**
![[Cyber Pentest/Assembly/assets/format_m√©moire_bis.png]]

For Windows (PE) executables, use `python readpe` or `pe-bear` for a GUI.

### Registers

#### Main registers by size

| 64 bits | 32 bits | 16 bits | 8 bits (strong) | 8 bits (weak) |
| ------- | ------- | ------- | --------------- | ------------- |
| `rax`   | `eax`   | `ax`    | `ah`            | `al`          |
| `rbx`   | `ebx`   | `bx`    | `bh`            | `bl`          |
| `rcx`   | `ecx`   | `cx`    | `ch`            | `cl`          |
| `rdx`   | `edx`   | `dx`    | `dh`            | `dl`          |
| `rdi`   | `edi`   | `di`    | -               | `dil`         |
| `rsi`   | `esi`   | `si`    | -               | `sil`         |
| `rbp`   | `ebp`   | `bp`    | -               | `bpl`         |
| `rsp`   | `esp`   | `sp`    | -               | `spl`         |
| `rN`    | `rNd`   | `rNw`   | -               | `rNl`         |

#### Other registers

##### EFLAGS registers
Theses flag doen't stock data but each bit have a specific signification

###### ZF (Zero Flag) 
The `ZF` flag is equal to `1` if the result of an operation is `0`; otherwise, `ZF` will be equal to `0`.

```Example
   0000 0011
-  0000 0011
-------------
   0000 0000
```
Here, the substraction result is equal to `0000 0000`, so the `ZF` will be set to `1`

###### CF (Carry Flag) 
The `CF` flag is equal to `1` if there is a carry out on an operation; otherwise, `CF` will be equal to `0`

```Example
   1111 1111
+  0000 0001
-----------
  1 0000 0000
```
Here, the result `1 0000 0000` is on 9 bits but we only have 8 bits, so the `CF` will be set to `1`

###### SF (Sign Flag)
The `SF` flag is equal to `1` if the result of an operation is negative; otherwise, `ZF` will be equal to `0`

###### OF (Overflow Flag)
The `OF` flag is equal to `1` if the result of an operation create an overflow; otherwise, `OF` will be equal to `0`

###### PF (Parity Flag)
The `PF` flag is equal to `1` if the number of bits set to 1 is even; otherwise, `PF` will be equal to `0`

###### IF (Interrupt Enable Flag)
The `IF` flag is equal to `1` to activate or `0` to desactivate material interruption

###### TF (Trap Flag)
The `TF` flag is equal to `1` to activate to debug or `0` otherwise, where the CPU generate an interruption after each instruction

